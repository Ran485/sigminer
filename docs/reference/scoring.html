<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Score Copy Number Profile — scoring • sigminer</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Score Copy Number Profile — scoring" />
<meta property="og:description" content="Returns quantification of copy number profile and events including
tandem duplication and Chromothripisis etc.
Only copy number data from autosome is used here.
Some of the quantification methods are rough,
you use at your risk. You should do some extra work to check the
result scores." />
<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sigminer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ShixiangWang/sigminer">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Score Copy Number Profile</h1>
    <small class="dont-index">Source: <a href='https://github.com/ShixiangWang/sigminer/blob/master/R/scoring.R'><code>R/scoring.R</code></a></small>
    <div class="hidden name"><code>scoring.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Returns quantification of copy number profile and events including
tandem duplication and Chromothripisis etc.
Only copy number data from autosome is used here.
<strong>Some of the quantification methods are rough,
you use at your risk</strong>. You should do some extra work to check the
result scores.</p>
    </div>

    <pre class="usage"><span class='fu'>scoring</span>(<span class='no'>object</span>, <span class='kw'>TD_size_cutoff</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1000</span>, <span class='fl'>1e+05</span>, <span class='fl'>2e+06</span>))</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>a object of <a href='CopyNumber-class.html'>CopyNumber</a>.</p></td>
    </tr>
    <tr>
      <th>TD_size_cutoff</th>
      <td><p>a length-3 numeric vector used to specify the start, midpoint, end
segment size for determining tandem duplication size range, midpoint is used to split
TD into short TD and long TD. Default is 1Kb to 100Kb for short TD, 100Kb to 2Mb for long
TD.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a <code>data.table</code> with following scores:</p><ul>
<li><p>cnaBurden: CNA burden representing the altered genomic fraction as previously reported.</p></li>
<li><p>cnaLoad: CNA load representing the quantity of copy number alteration.</p></li>
<li><p>MACN: mean altered copy number (MACN) reflecting the property of altered copy number segments,
calculated as
$$MACN = \frac{\sum_{i} CN_i}{N_{cnv}}$$
where \(CN_i\) is the copy number of altered segment \(i\), \(N_{cnv}\) is
the number of CNV.</p></li>
<li><p>weightedMACN: same as MACN but weighted with segment length.
$$MACN_{weighted} = \frac{\sum_{i} (CN_i \times L_{i})}{ \sum_{i} L_{i} }$$
where \(L_{i}\) is the length of altered copy number segment \(i\).</p></li>
<li><p>Ploidy: ploidy, the formula is same as <code>weightedMACN</code> but using all copy number segments instead of
altered copy number segments.</p></li>
<li><p>TDP: tandem duplication phenotype score from <a href='https://www.pnas.org/content/113/17/E2373'>https://www.pnas.org/content/113/17/E2373</a>,
the threshold <code>k</code> in reference is omitted.
$$TDP = - \frac{\sum_{chr} |TD_{obs}-TD_{exp}|}{TD_{total}}$$
where \(TD_{total}\) is the number of TD, \(TD_{obs}\) and
\(TD_exp\) are observed number of TD and expected number of TD for each chromosome.</p></li>
<li><p>sTDP: TDP score for short TD.</p></li>
<li><p>lTDP: TDP score for long TD.</p></li>
<li><p>TD: tandem duplication score, TD represents segment with copy number greater than 2.
$$TD = \frac{TD_{total}}{\sum_{chr} |TD_{obs}-TD_{exp}|+1}$$</p></li>
<li><p>sTD: TD score for short TD.</p></li>
<li><p>lTD: TD score for long TD.</p></li>
<li><p>Chromothripisis: according to reference <a href='http://dx.doi.org/10.1016/j.cell.2013.02.023'>http://dx.doi.org/10.1016/j.cell.2013.02.023</a>,
Chromothripsis frequently leads to massive loss of segments on
the affected chromosome with segmental losses being interspersed with regions displaying
normal (disomic) copy-number (e.g., copy-number states oscillating between
copy-number = 1 and copy-number = 2), form tens to hundreds of locally clustered DNA rearrangements.
Most of methods use both SV and CNV to infer chromothripsis, here we roughly quantify it with
$$\sum_{chr}{N_{OsCN}^2}$$
where \(N_{OsCN}\) is the number of oscillating copy number pattern "2-1-2" for each chromosome.</p></li>
</ul>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Load copy number object</span>
<span class='fu'><a href='https://rdrr.io/r/base/load.html'>load</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='st'>"toy_copynumber.RData"</span>,
  <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"sigminer"</span>, <span class='kw'>mustWork</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
))

<span class='fu'>scoring</span>(<span class='no'>cn</span>)</div><div class='output co'>#&gt;                           sample    cnaBurden cnaLoad MACN weightedMACN Ploidy
#&gt;  1: TCGA-05-4417-01A-22D-1854-01 0.6535735305    5.36 3.85         3.53   3.00
#&gt;  2: TCGA-06-0644-01A-02D-0310-01 0.1651843925    4.32 1.47         2.10   2.02
#&gt;  3: TCGA-19-2621-01B-01D-0911-01 0.0991005307    3.91 3.07         1.10   1.91
#&gt;  4: TCGA-26-6174-01A-21D-1842-01 0.1186037707    3.81 2.08         2.60   2.07
#&gt;  5: TCGA-99-7458-01A-11D-2035-01 0.3180319443    4.75 2.27         1.63   1.88
#&gt;  6: TCGA-A5-A0G2-01A-11D-A042-01 0.3931655541    4.86 1.29         1.62   1.85
#&gt;  7: TCGA-A8-A07S-01A-11D-A036-01 0.1123575193    3.58 1.45         2.17   2.02
#&gt;  8: TCGA-B6-A0X5-01A-21D-A107-01 0.0872390204    3.32 1.89         1.94   1.99
#&gt;  9: TCGA-CV-7432-01A-11D-2128-01 0.1976249853    4.25 2.39         2.02   2.00
#&gt; 10: TCGA-DF-A2KN-01A-11D-A17U-01 0.0003297153    2.81 2.83         2.98   2.00
#&gt;           TDP      sTDP      lTDP        TD       sTD       lTD Chromothripisis
#&gt;  1: -1.818182       NaN -1.818182 0.4313725 0.0000000 0.4313725               0
#&gt;  2: -1.909091       NaN -1.909091 0.3437500 0.0000000 0.3437500              13
#&gt;  3: -1.818182       NaN -1.818182 0.4954955 0.0000000 0.4954955               0
#&gt;  4: -1.545455 -1.909091 -1.636364 0.5840708 0.3437500 0.5445545               9
#&gt;  5: -1.545455       NaN -1.545455 0.5840708 0.0000000 0.5840708              10
#&gt;  6: -1.909091 -1.909091       NaN 0.3437500 0.3437500 0.0000000               6
#&gt;  7:       NaN       NaN       NaN 0.0000000 0.0000000 0.0000000              34
#&gt;  8: -1.909091       NaN -1.909091 0.4459459 0.0000000 0.4459459               0
#&gt;  9: -1.909091       NaN -1.909091 0.3437500 0.0000000 0.3437500               7
#&gt; 10: -1.727273 -1.818182 -1.818182 0.5188679 0.4313725 0.4647887               1</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://orcid.org/0000-0001-9855-7357'>Shixiang Wang</a>, <a href='https://orcid.org/0000-0002-7736-0077'>Xue-Song Liu</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


