<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Estimate Signature Number — sig_estimate • sigminer</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Estimate Signature Number — sig_estimate" />
<meta property="og:description" content="Use NMF package to evaluate the optimal number of signatures.
This is used along with sig_extract.
Users should library(NMF) firstly." />
<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sigminer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ShixiangWang/sigminer">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate Signature Number</h1>
    <small class="dont-index">Source: <a href='https://github.com/ShixiangWang/sigminer/blob/master/R/sig_estimate.R'><code>R/sig_estimate.R</code></a></small>
    <div class="hidden name"><code>sig_estimate.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Use <strong>NMF</strong> package to evaluate the optimal number of signatures.
This is used along with <a href='sig_extract.html'>sig_extract</a>.
Users should <code><a href='https://rdrr.io/r/base/library.html'>library(NMF)</a></code> firstly.</p>
    </div>

    <pre class="usage"><span class='fu'>sig_estimate</span>(
  <span class='no'>nmf_matrix</span>,
  <span class='kw'>range</span> <span class='kw'>=</span> <span class='fl'>2</span>:<span class='fl'>5</span>,
  <span class='kw'>nrun</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>keep_nmfObj</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>what</span> <span class='kw'>=</span> <span class='st'>"all"</span>,
  <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>123456</span>,
  <span class='kw'>use_random</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>save_plots</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>plot_basename</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span>(), <span class='st'>"nmf"</span>),
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"brunet"</span>,
  <span class='kw'>pConstant</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>nmf_matrix</th>
      <td><p>a <code>matrix</code> used for NMF decomposition with rows indicate samples and columns indicate components.</p></td>
    </tr>
    <tr>
      <th>range</th>
      <td><p>a <code>numeric</code> vector containing the ranks of factorization to try. Note that duplicates are removed
and values are sorted in increasing order. The results are notably returned in this order.</p></td>
    </tr>
    <tr>
      <th>nrun</th>
      <td><p>a <code>numeric</code> giving the number of run to perform for each value in <code>range</code>, <code>nrun</code> set to 30~50 is
enough to achieve robust result.</p></td>
    </tr>
    <tr>
      <th>keep_nmfObj</th>
      <td><p>default is <code>FALSE</code>, if <code>TRUE</code>, keep NMF objects from runs, and the result may be huge.</p></td>
    </tr>
    <tr>
      <th>what</th>
      <td><p>a character vector whose elements partially match one of the following item, which correspond to
the measures computed by summary on each multi-run NMF result: ‘all’, ‘cophenetic’, ‘rss’, ‘residuals’,
‘dispersion’, ‘evar’, ‘silhouette’ (and more specific .coef, .basis, .consensus), ‘sparseness’
(and more specific .coef, .basis). It specifies which measure must be plotted
(what='all' plots all the measures).</p></td>
    </tr>
    <tr>
      <th>cores</th>
      <td><p>number of cpu cores to run NMF.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>specification of the starting point or seeding method, which will compute a starting point,
usually using data from the target matrix in order to provide a good guess.</p></td>
    </tr>
    <tr>
      <th>use_random</th>
      <td><p>Should generate random data from input to test measurements. Default is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>save_plots</th>
      <td><p>if <code>TRUE</code>, save plots to local machine. Of note, if pdf file consensus map
has extra blank page, please call
<code><a href='https://rdrr.io/r/grDevices/pdf.html'>pdf(..., onefile=FALSE)</a></code>, it may fix this problem, see
<a href='https://stackoverflow.com/questions/12481267/in-r-how-to-prevent-blank-page-in-pdf-when-using-gridbase-to-embed-subplot-insi'>https://stackoverflow.com/questions/12481267/in-r-how-to-prevent-blank-page-in-pdf-when-using-gridbase-to-embed-subplot-insi</a>.</p></td>
    </tr>
    <tr>
      <th>plot_basename</th>
      <td><p>when save plots, set custom basename for file path.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>specification of the NMF algorithm. Use 'brunet' as default.
Available methods for nmf decompositions are 'brunet', 'lee', 'ls-nmf', 'nsNMF', 'offset'.</p></td>
    </tr>
    <tr>
      <th>pConstant</th>
      <td><p>A small positive value (like 1e-9) to add to the matrix.
Use it ONLY if the functions throws
an <code>non-conformable arrays</code> error.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>if <code>TRUE</code>, print extra message.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a <code>list</code> contains information of NMF run and rank survey.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The most common approach is to choose the smallest rank for which cophenetic correlation coefficient
starts decreasing (Used by this function). Another approach is to choose the rank for which the plot
of the residual sum of squares (RSS) between the input matrix and its estimate shows an inflection point.
More custom features please directly use <a href='https://rdrr.io/pkg/NMF/man/nmfEstimateRank.html'>NMF::nmfEstimateRank</a>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Gaujoux, Renaud, and Cathal Seoighe. "A flexible R package for nonnegative matrix factorization." BMC bioinformatics 11.1 (2010): 367.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='sig_extract.html'>sig_extract</a> for extracting signatures using <strong>NMF</strong> package, <a href='sig_auto_extract.html'>sig_auto_extract</a> for
extracting signatures using automatic relevance determination technique.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='co'># Load copy number prepare object</span>
<span class='fu'><a href='https://rdrr.io/r/base/load.html'>load</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='st'>"toy_copynumber_prepare.RData"</span>,
  <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"sigminer"</span>, <span class='kw'>mustWork</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
))
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>NMF</span>)
<span class='no'>cn_estimate</span> <span class='kw'>&lt;-</span> <span class='fu'>sig_estimate</span>(<span class='no'>cn_prepare</span>$<span class='no'>nmf_matrix</span>,
  <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>nrun</span> <span class='kw'>=</span> <span class='fl'>5</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</div><div class='output co'>#&gt; Compute NMF rank= 2  ... + measures ... OK
#&gt; Compute NMF rank= 3  ... + measures ... OK
#&gt; Compute NMF rank= 4  ... + measures ... OK
#&gt; Compute NMF rank= 5  ... + measures ... OK</div><div class='output co'>#&gt; <span class='message'>Estimation of rank based on observed data.</span></div><div class='output co'>#&gt;   method   seed rng metric rank sparseness.basis sparseness.coef       rss
#&gt; 2 brunet random   2     KL    2        0.7868164       0.4341062 1144.8714
#&gt; 3 brunet random   1     KL    3        0.7944475       0.4388444  813.1814
#&gt; 4 brunet random   2     KL    4        0.7944389       0.4887652  586.2708
#&gt; 5 brunet random   2     KL    5        0.7901255       0.4419127  368.2307
#&gt;        evar silhouette.coef silhouette.basis residuals niter   cpu cpu.all nrun
#&gt; 2 0.9985533       1.0000000        1.0000000  41.97589   570 0.051   2.900    5
#&gt; 3 0.9989724       0.7286187        0.5627588  31.71708   630 0.057   2.931    5
#&gt; 4 0.9992592       0.5586978        0.5559367  22.86119  1400 0.081   2.998    5
#&gt; 5 0.9995347       0.0273156        0.2546472  15.37598  1380 0.061   2.961    5
#&gt;   cophenetic dispersion silhouette.consensus
#&gt; 2  0.9545457     0.7312            0.8794444
#&gt; 3  0.8491389     0.5008            0.4788515
#&gt; 4  0.8595682     0.4112            0.2998276
#&gt; 5  0.7723529     0.6032            0.1758547</div><div class='output co'>#&gt; <span class='message'>Generating random matrix and run NMF...</span></div><div class='output co'>#&gt; Compute NMF rank= 2  ... + measures ... OK
#&gt; Compute NMF rank= 3  ... + measures ... OK
#&gt; Compute NMF rank= 4  ... + measures ... OK
#&gt; Compute NMF rank= 5  ... + measures ... OK</div><div class='output co'>#&gt; <span class='message'>Estimation of rank based on random data.</span></div><div class='output co'>#&gt;   method   seed rng metric rank sparseness.basis sparseness.coef       rss
#&gt; 2 brunet random   2     KL    2        0.5997533       0.9039689 377521.64
#&gt; 3 brunet random   1     KL    3        0.6831360       0.9190830 254488.45
#&gt; 4 brunet random   2     KL    4        0.7510472       0.9008415 177285.46
#&gt; 5 brunet random   2     KL    5        0.7933783       0.9092956  81028.84
#&gt;        evar silhouette.coef silhouette.basis residuals niter   cpu cpu.all nrun
#&gt; 2 0.5229561       1.0000000        1.0000000 2608.7704   420 0.029   2.934    5
#&gt; 3 0.6784233       0.9983423        0.7955868 1776.1591   420 0.043   3.060    5
#&gt; 4 0.7759785       0.8916780        0.6182755 1152.7439   420 0.033   3.151    5
#&gt; 5 0.8976103       0.7897915        0.5349317  672.1096   440 0.037   2.978    5
#&gt;   cophenetic dispersion silhouette.consensus
#&gt; 2  0.8879280     0.4688            0.6423333
#&gt; 3  0.9407022     0.6352            0.6407686
#&gt; 4  0.9818863     0.8272            0.6555556
#&gt; 5  0.9788747     0.8080            0.6111111</div><div class='img'><img src='sig_estimate-1.png' alt='' width='700' height='433' /></div><div class='input'># }
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Shixiang Wang</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://shixiangwang.github.io/'>Shixiang Wang</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


