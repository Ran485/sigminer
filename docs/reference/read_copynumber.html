<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Read Absolute Copy Number Profile — read_copynumber • sigminer</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Read Absolute Copy Number Profile — read_copynumber" />
<meta property="og:description" content="Read absolute copy number profile for preparing CNV signature
analysis." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sigminer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/sigminer.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ShixiangWang/sigminer/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Read Absolute Copy Number Profile</h1>
    <small class="dont-index">Source: <a href='https://github.com/ShixiangWang/sigminer/blob/master/R/read_copynumber.R'><code>R/read_copynumber.R</code></a></small>
    <div class="hidden name"><code>read_copynumber.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Read <strong>absolute</strong> copy number profile for preparing CNV signature
analysis.</p>
    </div>

    <pre class="usage"><span class='fu'>read_copynumber</span>(
  <span class='no'>input</span>,
  <span class='kw'>pattern</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>ignore_case</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>seg_cols</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Chromosome"</span>, <span class='st'>"Start.bp"</span>, <span class='st'>"End.bp"</span>, <span class='st'>"modal_cn"</span>),
  <span class='kw'>samp_col</span> <span class='kw'>=</span> <span class='st'>"sample"</span>,
  <span class='kw'>join_adj_seg</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>use_all</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>min_segnum</span> <span class='kw'>=</span> <span class='fl'>0L</span>,
  <span class='kw'>max_copynumber</span> <span class='kw'>=</span> <span class='fl'>20L</span>,
  <span class='kw'>genome_build</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"hg19"</span>, <span class='st'>"hg38"</span>),
  <span class='kw'>genome_measure</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"called"</span>, <span class='st'>"wg"</span>),
  <span class='kw'>complement</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>input</th>
      <td><p>a <code>data.frame</code> or a file or a directory contains copy number profile.</p></td>
    </tr>
    <tr>
      <th>pattern</th>
      <td><p>an optional regular expression used to select part of files if
<code>input</code> is a directory, more detail please see <a href='https://rdrr.io/r/base/list.files.html'>list.files</a> function.</p></td>
    </tr>
    <tr>
      <th>ignore_case</th>
      <td><p>logical. Should pattern-matching be case-insensitive?</p></td>
    </tr>
    <tr>
      <th>seg_cols</th>
      <td><p>four characters used to specify chromosome, start position,
end position and copy number value in <code>input</code>, respectively.
Default use names from ABSOLUTE calling result.</p></td>
    </tr>
    <tr>
      <th>samp_col</th>
      <td><p>a character used to specify the sample column name. If <code>input</code>
is a directory and cannot find <code>samp_col</code>, sample names will use file names
(set this parameter to <code>NULL</code> is recommended in this case).</p></td>
    </tr>
    <tr>
      <th>join_adj_seg</th>
      <td><p>if <code>TRUE</code> (default), join adjacent segments with
same copy number value. This is helpful for precisely count the number of breakpoint.</p></td>
    </tr>
    <tr>
      <th>use_all</th>
      <td><p>default is <code>FALSE</code>. If <code>True</code>, use all columns from raw input.</p></td>
    </tr>
    <tr>
      <th>min_segnum</th>
      <td><p>minimal number of copy number segments within a sample.</p></td>
    </tr>
    <tr>
      <th>max_copynumber</th>
      <td><p>bigger copy number within a sample will be reset to this value.</p></td>
    </tr>
    <tr>
      <th>genome_build</th>
      <td><p>genome build version, should be 'hg19' or 'hg38'.</p></td>
    </tr>
    <tr>
      <th>genome_measure</th>
      <td><p>default is 'called', can be 'wg' or 'called'.
Set 'called' will use called segments size to compute total size for CNA burden calculation,
this option is useful for WES and target sequencing.
Set 'wg' will use autosome size from genome build, this option is useful for WGS, SNP etc..</p></td>
    </tr>
    <tr>
      <th>complement</th>
      <td><p>if <code>TRUE</code>, complement chromosome (except 'Y') does not show in input data
with normal copy 2 and force <code>use_all</code> to <code>FALSE</code> (no matter what user input).</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>print extra messages.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other parameters pass to <code><a href='https://rdrr.io/pkg/data.table/man/fread.html'>data.table::fread()</a></code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a <a href='CopyNumber-class.html'>CopyNumber</a> object</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='read_maf.html'>read_maf</a> for reading mutation data to <a href='MAF-class.html'>MAF</a> object.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Load toy dataset of absolute copynumber profile</span>
<span class='fu'><a href='https://rdrr.io/r/base/load.html'>load</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='st'>"toy_segTab.RData"</span>,
  <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"sigminer"</span>, <span class='kw'>mustWork</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
))
<span class='no'>cn</span> <span class='kw'>&lt;-</span> <span class='fu'>read_copynumber</span>(<span class='no'>segTabs</span>,
  <span class='kw'>seg_cols</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"chromosome"</span>, <span class='st'>"start"</span>, <span class='st'>"end"</span>, <span class='st'>"segVal"</span>),
  <span class='kw'>genome_build</span> <span class='kw'>=</span> <span class='st'>"hg19"</span>, <span class='kw'>complement</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</div><div class='output co'>#&gt; <span class='message'>Treating input as a data frame...</span></div><div class='output co'>#&gt; <span class='message'>Checking chromosome names...</span></div><div class='output co'>#&gt; <span class='message'>Segments info:</span></div><div class='output co'>#&gt; <span class='message'>    Keep - 467</span></div><div class='output co'>#&gt; <span class='message'>  Filter - 0</span></div><div class='output co'>#&gt; <span class='message'>Joining adjacent segments with same copy number value...</span></div><div class='output co'>#&gt; <span class='message'>Anotating...</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Summarizing per sample...</span></div><div class='output co'>#&gt; <span class='message'>Done!</span></div><div class='input'><span class='no'>cn</span></div><div class='output co'>#&gt; An object of class CopyNumber 
#&gt; =============================
#&gt;                           sample n_of_seg n_of_cnv n_of_amp n_of_del n_of_vchr
#&gt;  1: TCGA-DF-A2KN-01A-11D-A17U-01       33        6        5        1         4
#&gt;  2: TCGA-19-2621-01B-01D-0911-01       33        8        5        3         5
#&gt;  3: TCGA-B6-A0X5-01A-21D-A107-01       28        8        4        4         2
#&gt;  4: TCGA-A8-A07S-01A-11D-A036-01       38       11        2        9         4
#&gt;  5: TCGA-26-6174-01A-21D-1842-01       43       13        8        5         8
#&gt;  6: TCGA-CV-7432-01A-11D-2128-01       40       16        7        9         9
#&gt;  7: TCGA-06-0644-01A-02D-0310-01       46       19        5       14         8
#&gt;  8: TCGA-A5-A0G2-01A-11D-A042-01       39       21        5       16        10
#&gt;  9: TCGA-99-7458-01A-11D-2035-01       48       26       10       16        13
#&gt; 10: TCGA-05-4417-01A-22D-1854-01       52       37       33        4        17
#&gt;     cna_burden
#&gt;  1:      0.000
#&gt;  2:      0.099
#&gt;  3:      0.087
#&gt;  4:      0.112
#&gt;  5:      0.119
#&gt;  6:      0.198
#&gt;  7:      0.165
#&gt;  8:      0.393
#&gt;  9:      0.318
#&gt; 10:      0.654</div><div class='input'>
<span class='no'>tab_file</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='st'>"metastatic_tumor.segtab.txt"</span>,
  <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"sigminer"</span>, <span class='kw'>mustWork</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)
<span class='no'>cn2</span> <span class='kw'>&lt;-</span> <span class='fu'>read_copynumber</span>(<span class='no'>tab_file</span>)
<span class='no'>cn2</span></div><div class='output co'>#&gt; An object of class CopyNumber 
#&gt; =============================
#&gt;              sample n_of_seg n_of_cnv n_of_amp n_of_del n_of_vchr cna_burden
#&gt; 1: metastatic_tumor      180      110       92       18        21      0.361</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://orcid.org/0000-0001-9855-7357'>Shixiang Wang</a>, <a href='https://orcid.org/0000-0002-7736-0077'>Xue-Song Liu</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


